function [dsidt, B1term, B2term, B3term, B4term, B5term] = get_dsdt_planar(B1i, B2i, B3i, B4i, B5i, w1, w2, w3, w4, s1)

  B1term = B1i{1,1}.*(w1.*w1) + ...
          B1i{1,2}.*(w1.*w2) + ...
          B1i{1,3}.*(w1.*w3) + ...
          B1i{1,4}.*(w1.*w4) + ...
      B1i{2,1}.*(w2.*w1) + ...
          B1i{2,2}.*(w2.*w2) + ...
          B1i{2,3}.*(w2.*w3) + ...
          B1i{2,4}.*(w2.*w4) + ...
      B1i{3,1}.*(w3.*w1) + ...
          B1i{3,2}.*(w3.*w2) + ...
          B1i{3,3}.*(w3.*w3) + ...
          B1i{3,4}.*(w3.*w4) + ...
      B1i{4,1}.*(w4.*w1) + ...
          B1i{4,2}.*(w4.*w2) + ...
          B1i{4,3}.*(w4.*w3) + ...
          B1i{4,4}.*(w4.*w4);

  B2term = B2i{1,1}.*(w1.*s1) + ...
      B2i{2,1}.*(w2.*s1) + ...
      B2i{3,1}.*(w3.*s1) + ...
      B2i{4,1}.*(w4.*s1);

  B3term = B3i{1,1}.*(s1.*w1) + ...
          B3i{1,2}.*(s1.*w2) + ...
          B3i{1,3}.*(s1.*w3) + ...
          B3i{1,4}.*(s1.*w4);

  B4term = B4i{1,1}.*(s1.*s1);

  B5term = B5i;

  dsidt = -B1term-B2term-B3term-B4term-B5term;

end
